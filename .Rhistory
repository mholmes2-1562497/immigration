<<<<<<< HEAD
"2009" = "2009",
"2010" = "2010"
)
),
mainPanel(
bubblesOutput("bubbles", width = "100%", height = "100%")
)
)
)
)
))
runApp()
runApp()
tabPanel("Please work",
titlePanel("Comparing returned immigrants to removed immigrants by region"),
sidebarLayout(
sidebarPanel(
selectInput(inputId= "year",
label= "Which Year",
choices = c(
"2006" = "2006",
"2007" = "2007",
"2008" = "2008",
"2009" = "2009",
"2010" = "2010"
)
),
mainPanel(
bubblesOutput("bubbles", width = "100%", height = "100%")
)
)
)
)
library(dplyr)
library(shiny)
library(plotly)
library(ggplot2)
library(markdown)
library(bubbles)
devtools::install_github("jcheng5/bubbles", force = TRUE)
#bubblesOutput(outputId, width = "600px", height = "600px")
shinyUI(navbarPage("U.S. Immigration data",
tabPanel("homepage",
titlePanel("Introduction"),
sidebarLayout(
mainPanel(
p("Immigration is such an important aspect of American life, it is an instition that affects us all. Through these tough political times,
immigration have become a crucial part of the lives of Americans - both citizens, and immigrants themeslves. The Trump administration
particularly has put a negative connotation on the word 'immigrant'; claiming that immigrants coming into the U.S. (especially from Mexico),
are contributing to the nation's most pressing issues (such as drug epidemics, loss of jobs, more crime, etc). This app is an exploration of
analyzing facts through true statistics, and seeing the effects of the current situation on countless individuals seeking the American dream.
Using data gathered from the Department of Homeland Security (DHS) and the Bureau of Justice, we have formulated a holistic study of immigration
trends in the U.S., with a specific emphasis on Mexico."
),
p("Through our research, we've found that there are different types of statuses immigrants can have. Each of which the Department of Homeland Security
had different data sets for:"
),
p(strong("Returned: "), "A returned immigrant is one who has voluntarily returned to their home country after their access into the U.S. has been denied,
or their visa expired. As a returned immigrant they waive their right to a formal proceeding, or in response to a removal proceeding."
),
p(strong("Removed: "), "A removed immigrant is one who has been determined as deportable (like a returned immigrant) but has not decided to leave the U.S.
voluntarily, meaning they could be subject to administrative penalties and may face criminal charges upon re-entry. The DHS data set
on removed immigrants includes numbers on those who did have a criminal record upon removal, and those who did not."
),
p(strong("Apprehended: "), "An apprehension is an action taken by law enforcement agency to take physical control of a person. If one individual is apprehended
more than once in one given year, it is counted twice in the data set"),
p(strong("Determined Inadmissable: "), "An immigrant may be denied access to the U.S. at a port of entry for not meeting criteria for admission. Once given this
status, they may be placed in removal proceedings or given the opportunity to withdraw their application.")
),
sidebarPanel(
helpText("here are some links to our sources:",
br(),
a("Full glossary of terms",
href = "https://www.dhs.gov/immigration-statistics/data-standards-and-definitions/definition-terms",
target = "_blank"),
br(),
a("Webpage with original datasets from DHS",
href = "https://www.dhs.gov/immigration-statistics/enforcement-actions#",
target = "_blank"),
br(),
a("DHS frequently asked questions",
href = "https://www.dhs.gov/immigration-statistics/FAQs",
target = "_blank")
)
)
)
),
tabPanel("World map",
titlePanel("Mapping removed immigrants based on criminal background"),
sidebarLayout(
sidebarPanel(
selectInput("status", "Select criminal status:",
choices = list("Criminal" = "criminal", "Non-criminal" = "noncriminal")
),
selectInput("year", "Select year:",
choices = list("2006" = 1, "2007" = 2, "2008" = 3, "2009" = 4, "2010" = 5, "2011" = 6, "2012" = 7,
"2013" = 8, "2014" = 9, "2015" = 10)
),
sliderInput("max", "Select maximum amount to display:",
min = 0, max = 100000, value = 100000
),
helpText("Helps get rid of outliers to look at more minute relationships between countries"
)
),
mainPanel(
plotlyOutput("map")
)
)
),
tabPanel("Returned vs. Removed",
titlePanel("Comparing returned immigrants to removed immigrants by region"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "dataset",
label = "Choose a dataset:",
choices=c("graph.2009", "graph.2010", "graph.2011", "graph.2012", "graph.2013", "graph.2014", "graph.2015")
)
),
mainPanel(
plotOutput("region-plot")
)
)
),
tabPanel("Please work",
titlePanel("Comparing returned immigrants to removed immigrants by region"),
sidebarLayout(
sidebarPanel(
selectInput(inputId= "year",
label= "Which Year",
choices = c(
"2006" = "2006",
"2007" = "2007",
"2008" = "2008",
"2009" = "2009",
"2010" = "2010"
)
)),
mainPanel(
bubblesOutput("bubbles", width = "100%", height = "100%")
)
)
)
))
runApp()
bubbles(value = sample(10), label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
env = parent.frame()
quoted = FALSE
n<-1000
random<-1:n
ims <- filter(immigrant,Year == as.numeric(input$year))
ims<- gather(ims,"Reason","Amount", 1:7) %>%
filter(Reason == "Ratio")
ratio<- as.numeric(ims$Amount)*n
sample <- sample(random,ratio)
#use bubbles!
bubble.frame <- data.frame(random,0)
colnames(bubble.frame) <- c("Set", "Hit")
bubble.frame$Hit <- "green"
bubble.frame$Hit[sample] <- "blue"
bubbles(value = sample(10), label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
ims <- filter(immigrant,Year == as.numeric(input$year))
ims <- filter(immigrant,Year == as.numeric(2008))
ims<- gather(ims,"Reason","Amount", 1:7) %>%
filter(Reason == "Ratio")
ratio<- as.numeric(ims$Amount)*n
sample <- sample(random,ratio)
bubble.frame <- data.frame(random,0)
colnames(bubble.frame) <- c("Set", "Hit")
bubble.frame$Hit <- "green"
bubble.frame$Hit[sample] <- "blue"
bubbles(value = sample(10), label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
ims <- filter(immigrant,Year == as.numeric(input$year))
=======
removed <- read_excel("removed.xls")
return <- read.csv("~/Desktop/Info201/immigration/data/returned.csv")
remove <- read.csv("~/Desktop/Info201/immigration/data/removed.csv")
View(return)
View(return)
return.updated <- return[c(6:11)]
return.updated <- return[c(6:11),]
View(return.updated)
names(return.updated) <- c("2009", "2012", "2013", "2014", "2015")
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
shiny::runApp('Desktop/Info201/immigration')
return.updated2 <- return.updated[-c(10)]
return.updated2 <- return.updated[-c(10)]
return.updated2 <- return.updated[-c(10),]
return.updated2 <- return.updated[-c(5),]
return.updated2 <- return.updated[-c(5),]
shiny::runApp('Desktop/Info201/immigration')
names(remove.updated.year) <- c("NAM", "fgdf", "fddf", "fddf", "fddf", "fdfd", "df")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
return.updated2 <- return[-c(10),]
return.updated <- return.updated2[c(6:10),]
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
remove.updated2 <- remove[-c(11),]
remove.updated <- remove.updated2[c(7:11),]
return.updated.year <- select(return.updated,"2009","2010","2011", "2012","2013","2014","2015")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
names(remove.updated.year) <- c("NAM", "fgdf", "fddf", "fddf", "fddf", "fdfd", "df")
runApp('Desktop/Info201/immigration')
hi <- print(WorldPhones)
View(hi)
runApp('Desktop/Info201/a8-shiny-phillipleinfo201')
runApp('Desktop/Info201/immigration')
runApp('Desktop/Info201/a8-shiny-phillipleinfo201')
runApp('Desktop/Info201/immigration')
runApp('Desktop/Info201/immigration')
runApp('Desktop/Info201/immigration')
colnames(WorldPhones) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
runApp('Desktop/Info201/immigration')
colnames(hi) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
colnames(hi) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
View(WorldPhones)
rownames(hi) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
runApp('Desktop/Info201/immigration')
runApp('Desktop/Info201/immigration')
>>>>>>> 129161f28d8a24c8e38470525d6c80b18b4cddf0
library(dplyr)
library(shiny)
library(plotly)
library(ggplot2)
library(markdown)
<<<<<<< HEAD
library(datasets)
library(bubbles)
devtools::install_github("jcheng5/bubbles", force = TRUE)
# source("information.r", local = TRUE)
# source("map-plot.r", local = TRUE)
source("usinfo.r", local = TRUE)
renderBubbles(expr, env = parent.frame(), quoted = FALSE)
shinyServer(function(input, output) {
# reactive function to determine which year data frame to use (using year.list in R file)
select.year <- reactive({
year.data <- data.frame(year.list[as.numeric(input$year)])
return(year.data)
})
output$map <- renderPlotly({
#renders a different plot based on status
if(input$status == "noncriminal") {
#filters to exlude outliers
final.data <- filter(select.year(), noncriminal < input$max)
MakeNoncrimMap(final.data)
} else {
final.data <- filter(select.year(), criminal < input$max)
MakeCrimMap(final.data)
}
})
output$bubbles <- renderBubbles({
env = parent.frame()
quoted = FALSE
n<-1000
random<-1:n
ims <- filter(immigrant,Year == as.numeric(input$year))
ims<- gather(ims,"Reason","Amount", 1:7) %>%
filter(Reason == "Ratio")
ratio<- as.numeric(ims$Amount)*n
sample <- sample(random,ratio)
#use bubbles!
bubble.frame <- data.frame(random,0)
colnames(bubble.frame) <- c("Set", "Hit")
bubble.frame$Hit <- "green"
bubble.frame$Hit[sample] <- "blue"
bubbles(value = sample(10), label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
})
})
=======
library(readxl)
library(datasets)
returns <- print(WorldPhones)
removes <- print(WorldPhones)
rownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
rownames(returns) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
return <- read.csv("~/Desktop/Info201/immigration/data/returned.csv", stringsAsFactors = FALSE)
remove <- read.csv("~/Desktop/Info201/immigration/data/removed.csv", stringsAsFactors = FALSE)
return.updated2 <- return[-c(10),]
return.updated <- return.updated2[c(6:10),]
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
remove.updated2 <- remove[-c(11),]
remove.updated <- remove.updated2[c(7:11),]
return.updated.year <- select(return.updated,"2009","2010","2011", "2012","2013","2014","2015")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
names(remove.updated.year) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
runApp('Desktop/Info201/immigration')
View(removes)
runApp('Desktop/Info201/immigration')
shiny::runApp('Desktop/Info201/immigration')
>>>>>>> 129161f28d8a24c8e38470525d6c80b18b4cddf0
library(dplyr)
library(shiny)
library(plotly)
library(ggplot2)
library(markdown)
<<<<<<< HEAD
library(datasets)
library(bubbles)
devtools::install_github("jcheng5/bubbles", force = TRUE)
# source("information.r", local = TRUE)
# source("map-plot.r", local = TRUE)
source("usinfo.r", local = TRUE)
renderBubbles(expr, env = parent.frame(), quoted = FALSE)
shinyServer(function(input, output) {
# reactive function to determine which year data frame to use (using year.list in R file)
select.year <- reactive({
year.data <- data.frame(year.list[as.numeric(input$year)])
return(year.data)
})
output$map <- renderPlotly({
#renders a different plot based on status
if(input$status == "noncriminal") {
#filters to exlude outliers
final.data <- filter(select.year(), noncriminal < input$max)
MakeNoncrimMap(final.data)
} else {
final.data <- filter(select.year(), criminal < input$max)
MakeCrimMap(final.data)
}
})
output$bubbles <- renderBubbles({
env = parent.frame()
quoted = FALSE
n<-1000
random<-1:n
ims <- filter(immigrant,Year == as.numeric(input$year))
ims<- gather(ims,"Reason","Amount", 1:7) %>%
filter(Reason == "Ratio")
ratio<- as.numeric(ims$Amount)*n
sample <- sample(random,ratio)
#use bubbles!
bubble.frame <- data.frame(random,0)
colnames(bubble.frame) <- c("Set", "Hit")
bubble.frame$Hit <- "green"
bubble.frame$Hit[sample] <- "blue"
bubbles(value = 3, label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
})
})
runApp()
View(ims)
=======
library(readxl)
library(datasets)
ownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
rownames(returns) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
return <- read.csv("~/Desktop/Info201/immigration/data/returned.csv", stringsAsFactors = FALSE)
remove <- read.csv("~/Desktop/Info201/immigration/data/removed.csv", stringsAsFactors = FALSE)
return.updated2 <- return[-c(10),]
return.updated <- return.updated2[c(6:10),]
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
remove.updated2 <- remove[-c(11),]
remove.updated <- remove.updated2[c(7:11),]
return.updated.year <- select(return.updated,"2009","2010","2011", "2012","2013","2014","2015")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
names(remove.updated.year) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
runApp('Desktop/Info201/immigration')
rownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
rownames(returns) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
return <- read.csv("~/Desktop/Info201/immigration/data/returned.csv", stringsAsFactors = FALSE)
remove <- read.csv("~/Desktop/Info201/immigration/data/removed.csv", stringsAsFactors = FALSE)
return.updated2 <- return[-c(10),]
return.updated <- return.updated2[c(6:10),]
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
remove.updated2 <- remove[-c(11),]
remove.updated <- remove.updated2[c(7:11),]
return.updated.year <- select(return.updated,"2009","2010","2011", "2012","2013","2014","2015")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
names(remove.updated.year) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
View(removes)
runApp('Desktop/Info201/immigration')
setwd("~/Desktop/Info201/Immigration")
rownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
rownames(returns) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
return <- read.csv("~/Desktop/Info201/immigration/data/returned.csv", stringsAsFactors = FALSE)
remove <- read.csv("~/Desktop/Info201/immigration/data/removed.csv", stringsAsFactors = FALSE)
return.updated2 <- return[-c(10),]
return.updated <- return.updated2[c(6:10),]
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
remove.updated2 <- remove[-c(11),]
remove.updated <- remove.updated2[c(7:11),]
return.updated.year <- select(return.updated,"2009","2010","2011", "2012","2013","2014","2015")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
names(remove.updated.year) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
>>>>>>> 129161f28d8a24c8e38470525d6c80b18b4cddf0
library(dplyr)
library(shiny)
library(plotly)
library(ggplot2)
library(markdown)
<<<<<<< HEAD
library(datasets)
library(bubbles)
devtools::install_github("jcheng5/bubbles", force = TRUE)
# source("information.r", local = TRUE)
# source("map-plot.r", local = TRUE)
source("usinfo.r", local = TRUE)
renderBubbles(expr, env = parent.frame(), quoted = FALSE)
shinyServer(function(input, output) {
# reactive function to determine which year data frame to use (using year.list in R file)
select.year <- reactive({
year.data <- data.frame(year.list[as.numeric(input$year)])
return(year.data)
})
output$map <- renderPlotly({
#renders a different plot based on status
if(input$status == "noncriminal") {
#filters to exlude outliers
final.data <- filter(select.year(), noncriminal < input$max)
MakeNoncrimMap(final.data)
} else {
final.data <- filter(select.year(), criminal < input$max)
MakeCrimMap(final.data)
}
})
output$bubbles <- renderBubbles({
env = parent.frame()
quoted = FALSE
n<-1000
random<-1:n
ims <- filter(immigrant,Year == as.numeric(input$year))
ims<- gather(ims,"Reason","Amount", 1:7) %>%
filter(Reason == "Ratio")
ratio<- as.numeric(ims$Amount)*n
sample <- sample(random,ratio)
#use bubbles!
bubble.frame <- data.frame(random,0)
colnames(bubble.frame) <- c("Set", "Hit")
bubble.frame$Hit <- "green"
bubble.frame$Hit[sample] <- "blue"
bubbles(value = 3, label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
})
})
bubbles(value = sample(10), label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
runApp()
runApp()
bar.it(2010)
shinyUI(navbarPage("U.S. Immigration data",
tabPanel("homepage",
titlePanel("Introduction"),
sidebarLayout(
mainPanel(
p("Immigration is such an important aspect of American life, it is an instition that affects us all. Through these tough political times,
immigration have become a crucial part of the lives of Americans - both citizens, and immigrants themeslves. The Trump administration
particularly has put a negative connotation on the word 'immigrant'; claiming that immigrants coming into the U.S. (especially from Mexico),
are contributing to the nation's most pressing issues (such as drug epidemics, loss of jobs, more crime, etc). This app is an exploration of
analyzing facts through true statistics, and seeing the effects of the current situation on countless individuals seeking the American dream.
Using data gathered from the Department of Homeland Security (DHS) and the Bureau of Justice, we have formulated a holistic study of immigration
trends in the U.S., with a specific emphasis on Mexico."
),
p("Through our research, we've found that there are different types of statuses immigrants can have. Each of which the Department of Homeland Security
had different data sets for:"
),
p(strong("Returned: "), "A returned immigrant is one who has voluntarily returned to their home country after their access into the U.S. has been denied,
or their visa expired. As a returned immigrant they waive their right to a formal proceeding, or in response to a removal proceeding."
),
p(strong("Removed: "), "A removed immigrant is one who has been determined as deportable (like a returned immigrant) but has not decided to leave the U.S.
voluntarily, meaning they could be subject to administrative penalties and may face criminal charges upon re-entry. The DHS data set
on removed immigrants includes numbers on those who did have a criminal record upon removal, and those who did not."
),
p(strong("Apprehended: "), "An apprehension is an action taken by law enforcement agency to take physical control of a person. If one individual is apprehended
more than once in one given year, it is counted twice in the data set"),
p(strong("Determined Inadmissable: "), "An immigrant may be denied access to the U.S. at a port of entry for not meeting criteria for admission. Once given this
status, they may be placed in removal proceedings or given the opportunity to withdraw their application.")
),
sidebarPanel(
helpText("here are some links to our sources:",
br(),
a("Full glossary of terms",
href = "https://www.dhs.gov/immigration-statistics/data-standards-and-definitions/definition-terms",
target = "_blank"),
br(),
a("Webpage with original datasets from DHS",
href = "https://www.dhs.gov/immigration-statistics/enforcement-actions#",
target = "_blank"),
br(),
a("DHS frequently asked questions",
href = "https://www.dhs.gov/immigration-statistics/FAQs",
target = "_blank")
)
)
)
),
tabPanel("World map",
titlePanel("Mapping removed immigrants based on criminal background"),
sidebarLayout(
sidebarPanel(
selectInput("status", "Select criminal status:",
choices = list("Criminal" = "criminal", "Non-criminal" = "noncriminal")
),
selectInput("year", "Select year:",
choices = list("2006" = 1, "2007" = 2, "2008" = 3, "2009" = 4, "2010" = 5, "2011" = 6, "2012" = 7,
"2013" = 8, "2014" = 9, "2015" = 10)
),
sliderInput("max", "Select maximum amount to display:",
min = 0, max = 100000, value = 100000
),
helpText("Helps get rid of outliers to look at more minute relationships between countries"
)
),
mainPanel(
plotlyOutput("map")
)
)
),
tabPanel("Returned vs. Removed",
titlePanel("Comparing returned immigrants to removed immigrants by region"),
sidebarLayout(
sidebarPanel(
selectInput(inputId = "dataset",
label = "Choose a dataset:",
choices=c("graph.2009", "graph.2010", "graph.2011", "graph.2012", "graph.2013", "graph.2014", "graph.2015")
)
),
mainPanel(
plotOutput("region-plot")
)
)
),
tabPanel("Please work",
titlePanel("Comparing returned immigrants to removed immigrants by region"),
sidebarLayout(
sidebarPanel(
selectInput(inputId= "year",
label= "Which Year",
choices = c(
"2006" = "2006",
"2007" = "2007",
"2008" = "2008",
"2009" = "2009",
"2010" = "2010"
)
)),
mainPanel(s
bubblesOutput("bubbles", width = "100%", height = "100%")
)
)
)
))
bar.it(2006)
library(dplyr)
library(tidyr)
library(shiny)
library(plotly)
library(ggplot2)
library(markdown)
devtools::install_github("jcheng5/bubbles")
library(bubbles)
setwd("~/Info201/immigration")
removed <- read.csv("data/removed.csv", stringsAsFactors = FALSE)
removed <- removed[3:13,2:16 ]
#Get the right amount of Apprehended data
apprehended <- read.csv("data/apprehended.csv", stringsAsFactors = FALSE)
apprehended <- apprehended[3:5, 2:6 ]
colnames(apprehended) <- c("2006","2007","2008","2009","2010")
apprehended <- apprehended[-c(2), ]
apprehended <- gather(apprehended,"Year", "Apprehended",1:5)
apprehended <- apprehended[-c(1,3,5,7,9), ]
#Same with Immigrant
immigrant <- read.csv("data/us.immigrant.csv", stringsAsFactors = FALSE)
cols <- c("Year","Drug","Immigration","Other")
colnames(immigrant) <- cols
immigrant <- immigrant[31:35, ]
#Join together to plot later
immigrant <- full_join(immigrant,apprehended)
#Get rid of commas in the values
immigrant$Drug<-as.numeric(gsub(",", "", immigrant$Drug))
immigrant$Immigration<-as.numeric(gsub(",", "", immigrant$Immigration))
immigrant$Other<-as.numeric(gsub(",", "", immigrant$Other))
immigrant$Apprehended<-as.numeric(gsub(",", "", immigrant$Apprehended))
#Create extra tables based on the data
immigrant <- mutate(immigrant,Total = Drug+Immigration)
immigrant <- mutate(immigrant,Ratio = Total/Apprehended)
#Present graph
main.plot <- ggplot(data = immigrant)+
geom_line(mapping = aes(x= Year, y= Ratio, group=1))+
ggtitle("Percentage of People who are Arrested/Apprehended")
#Call above graph and use this function at the bottom
bar.it <- function(year){
year <- as.numeric(year)
#How big youd want the bubble graph to be
n<-1000
random<-1:n
ims <- filter(immigrant,Year == year)
ims<- gather(ims,"Reason","Amount", 1:7) %>%
filter(Reason == "Ratio")
ratio<- as.numeric(ims$Amount)*n
sample <- sample(random,ratio)
#use bubbles!
bubble.frame <- data.frame(random,0)
colnames(bubble.frame) <- c("Set", "Hit")
bubble.frame$Hit <- "green"
bubble.frame$Hit[sample] <- "blue"
bubbles(value = sample(10), label=" ", key = , tooltip = "One out of A Thousand", color = bubble.frame$Hit,
textColor = "#333333", width = NULL, height = NULL)
}
# bubblesOutput(outputId, width = "600px", height = "600px")
#
# renderBubbles(expr, env = parent.frame(), quoted = FALSE)
#
main.plot
bar.it(2006)
main.plot
bar.it(2008)
bar
2009
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
bar.it(2009)
=======
library(readxl)
library(datasets)
rownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
rownames(returns) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
return <- read.csv("~/Desktop/Info201/immigration/data/returned.csv", stringsAsFactors = FALSE)
remove <- read.csv("~/Desktop/Info201/immigration/data/removed.csv", stringsAsFactors = FALSE)
return.updated2 <- return[-c(10),]
return.updated <- return.updated2[c(6:10),]
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
remove.updated2 <- remove[-c(11),]
remove.updated <- remove.updated2[c(7:11),]
return.updated.year <- select(return.updated,"2009","2010","2011", "2012","2013","2014","2015")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
names(remove.updated.year) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
##2009 Removed
africa.criminal.2009 <- 718
africa.noncriminal.2009 <- 1304
asia.criminal.2009 <- 1334
asia.noncriminal.2009 <- 4906
europe.criminal.2009 <- 1078
europe.noncriminal.2009 <- 3537
northamerica.criminal.2009 <- 125416
northamerica.noncriminal.2009 <- 240531
southamerica.criminal.2009 <- 3118
southamerica.noncriminal.2009 <- 8951
##2010 Removed
africa.criminal.2010 <- 666
africa.noncriminal.2010 <- 1220
asia.criminal.2010 <- 1559
asia.noncriminal.2010 <- 4665
europe.criminal.2010 <- 1266
europe.noncriminal.2010 <- 2741
northamerica.criminal.2010 <- 162443
northamerica.noncriminal.2010 <- 195649
southamerica.criminal.2010 <- 3500
southamerica.noncriminal.2010 <- 7511
##2011 Removed
africa.criminal.2011 <- 647
africa.noncriminal.2011 <- 1015
asia.criminal.2011 <- 1567
asia.noncriminal.2011 <- 3737
europe.criminal.2011 <- 1236
europe.noncriminal.2011 <- 1999
northamerica.criminal.2011 <- 181887
northamerica.noncriminal.2011 <- 184009
southamerica.criminal.2011 <- 3396
southamerica.noncriminal.2011 <- 5892
##2012 Removed
africa.criminal.2012 <- 673
africa.noncriminal.2012 <- 761
asia.criminal.2012 <- 1469
asia.noncriminal.2012 <- 2862
europe.criminal.2012 <- 1275
europe.noncriminal.2012 <- 1468
northamerica.criminal.2012 <- 193320
northamerica.noncriminal.2012 <- 206206
southamerica.criminal.2012 <- 3204
southamerica.noncriminal.2012 <- 4372
##2013 Removed
africa.criminal.2013 <- 599
africa.noncriminal.2013 <- 615
asia.criminal.2013 <- 1135
asia.noncriminal.2013 <- 2013
europe.criminal.2013 <- 1082
europe.noncriminal.2013 <- 988
northamerica.criminal.2013 <- 193235
northamerica.noncriminal.2013 <- 227223
southamerica.criminal.2013 <- 2721
southamerica.noncriminal.2013 <- 3153
##2014 Removed
africa.criminal.2014 <- 521
africa.noncriminal.2014 <- 745
asia.criminal.2014 <- 1080
asia.noncriminal.2014 <- 1729
europe.criminal.2014 <- 890
europe.noncriminal.2014 <- 827
northamerica.criminal.2014 <- 167622
northamerica.noncriminal.2014 <- 226738
southamerica.criminal.2014 <- 2433
southamerica.noncriminal.2014 <- 2751
##2015 Removed
africa.criminal.2015 <- 380
africa.noncriminal.2015 <- 986
asia.criminal.2015 <- 812
asia.noncriminal.2015 <- 1852
europe.criminal.2015 <- 726
europe.noncriminal.2015 <- 737
northamerica.criminal.2015 <- 135466
northamerica.noncriminal.2015 <- 180578
southamerica.criminal.2015 <- 2087
southamerica.noncriminal.2015 <- 3122
## Africa Returned
africa.return.2009 <- 3073
africa.return.2010 <- 3441
africa.return.2011 <- 2389
africa.return.2012 <- 2389
africa.return.2013 <- 1505
africa.return.2014 <- 1710
africa.return.2015 <- 2187
## Asia Returned
asia.return.2009 <- 53825
asia.return.2010 <- 57788
asia.return.2011 <- 56693
asia.return.2012 <- 46361
asia.return.2013 <- 44554
asia.return.2014 <- 46552
asia.return.2015 <- 45424
## Europe Returned
europe.return.2009 <- 19254
europe.return.2010 <- 18196
europe.return.2011 <- 17185
europe.return.2012 <- 13291
europe.return.2013 <- 12403
europe.return.2014 <- 12159
europe.return.2015 <- 11493
## North America Returned
northamerica.return.2009 <- 501532
northamerica.return.2010 <- 390678
northamerica.return.2011 <- 241927
northamerica.return.2012 <- 166038
northamerica.return.2013 <- 117288
northamerica.return.2014 <- 100139
northamerica.return.2015 <- 67232
## South America Returned
southhamerica.return.2009 <- 3640
southhamerica.return.2010 <- 3139
southhamerica.return.2011 <- 2961
southhamerica.return.2012 <- 2174
southhamerica.return.2013 <- 2222
southhamerica.return.2014 <- 1957
southhamerica.return.2015 <- 2315
## 2009 Graph
Regions <- c("Africa", "Asia", "Europe", "North America", "South America")
remove_criminal_2009 <- c(africa.criminal.2009, asia.criminal.2009, europe.criminal.2009, northamerica.criminal.2009,
southamerica.criminal.2009)
remove_noncriminal_2009 <- c(africa.noncriminal.2009, asia.noncriminal.2009, europe.noncriminal.2009,
northamerica.noncriminal.2009, southamerica.noncriminal.2009)
return_2009 <- c(africa.return.2009, asia.return.2009, europe.return.2009, northamerica.return.2009, southhamerica.return.2009)
data.2009 <- data.frame(Regions, remove_criminal_2009, remove_noncriminal_2009)
graph.2009 <- plot_ly(data.2009, x = ~Regions, y = ~remove_criminal_2009, type = 'bar', name = 'Removed_Criminals') %>%
add_trace(y = ~return_2009, name = 'Returned') %>%
add_trace(y = ~remove_noncriminal_2009, name = 'Removed_NonCriminals') %>%
layout(title = "2009 Removal Criminal/Non Criminal and Returned", yaxis = list(title = 'Count'), barmode = 'group')
returns <- print(WorldPhones)
removes <- print(WorldPhones)
## 2010 Graph
Regions <- c("Africa", "Asia", "Europe", "North America", "South America")
remove_criminal_2010 <- c(africa.criminal.2010, asia.criminal.2010, europe.criminal.2010, northamerica.criminal.2010,
southamerica.criminal.2010)
remove_noncriminal_2010 <- c(africa.noncriminal.2010, asia.noncriminal.2010, europe.noncriminal.2010,
northamerica.noncriminal.2010, southamerica.noncriminal.2010)
return_2010 <- c(africa.return.2010, asia.return.2010, europe.return.2010, northamerica.return.2010, southhamerica.return.2010)
data.2010 <- data.frame(Regions, remove_criminal_2010, remove_noncriminal_2010)
graph.2010 <- plot_ly(data.2010, x = ~Regions, y = ~remove_criminal_2010, type = 'bar', name = 'Removed_Criminals') %>%
add_trace(y = ~return_2010, name = 'Returned') %>%
add_trace(y = ~remove_noncriminal_2010, name = 'Removed_NonCriminals') %>%
layout(title = "2010 Removal Criminal/Non Criminal and Returned", yaxis = list(title = 'Count'), barmode = 'group')
## 2011 Graph
Regions <- c("Africa", "Asia", "Europe", "North America", "South America")
remove_criminal_2011 <- c(africa.criminal.2011, asia.criminal.2011, europe.criminal.2011, northamerica.criminal.2011,
southamerica.criminal.2011)
remove_noncriminal_2011 <- c(africa.noncriminal.2011, asia.noncriminal.2011, europe.noncriminal.2011,
northamerica.noncriminal.2011, southamerica.noncriminal.2011)
return_2011 <- c(africa.return.2011, asia.return.2011, europe.return.2011, northamerica.return.2011, southhamerica.return.2011)
data.2011 <- data.frame(Regions, remove_criminal_2011, remove_noncriminal_2011)
graph.2011 <- plot_ly(data.2011, x = ~Regions, y = ~remove_criminal_2011, type = 'bar', name = 'Removed_Criminals') %>%
add_trace(y = ~return_2011, name = 'Returned') %>%
add_trace(y = ~remove_noncriminal_2011, name = 'Removed_NonCriminals') %>%
layout(title = "2011 Removal Criminal/Non Criminal and Returned", yaxis = list(title = 'Count'), barmode = 'group')
## 2012 Graph
Regions <- c("Africa", "Asia", "Europe", "North America", "South America")
remove_criminal_2012 <- c(africa.criminal.2012, asia.criminal.2012, europe.criminal.2012, northamerica.criminal.2012,
southamerica.criminal.2012)
remove_noncriminal_2012 <- c(africa.noncriminal.2012, asia.noncriminal.2012, europe.noncriminal.2012,
northamerica.noncriminal.2012, southamerica.noncriminal.2012)
return_2012 <- c(africa.return.2012, asia.return.2012, europe.return.2012, northamerica.return.2012, southhamerica.return.2012)
data.2012 <- data.frame(Regions, remove_criminal_2012, remove_noncriminal_2012)
graph.2012 <- plot_ly(data.2012, x = ~Regions, y = ~remove_criminal_2012, type = 'bar', name = 'Removed_Criminals') %>%
add_trace(y = ~return_2012, name = 'Returned') %>%
add_trace(y = ~remove_noncriminal_2012, name = 'Removed_NonCriminals') %>%
layout(title = "2012 Removal Criminal/Non Criminal and Returned", yaxis = list(title = 'Count'), barmode = 'group')
## 2013 Graph
Regions <- c("Africa", "Asia", "Europe", "North America", "South America")
remove_criminal_2013 <- c(africa.criminal.2013, asia.criminal.2013, europe.criminal.2013, northamerica.criminal.2013,
southamerica.criminal.2013)
remove_noncriminal_2013 <- c(africa.noncriminal.2013, asia.noncriminal.2013, europe.noncriminal.2013,
northamerica.noncriminal.2013, southamerica.noncriminal.2013)
return_2013 <- c(africa.return.2013, asia.return.2013, europe.return.2013, northamerica.return.2013, southhamerica.return.2013)
data.2013 <- data.frame(Regions, remove_criminal_2013, remove_noncriminal_2013)
graph.2013 <- plot_ly(data.2013, x = ~Regions, y = ~remove_criminal_2013, type = 'bar', name = 'Removed_Criminals') %>%
add_trace(y = ~return_2013, name = 'Returned') %>%
add_trace(y = ~remove_noncriminal_2013, name = 'Removed_NonCriminals') %>%
layout(title = "2013 Removal Criminal/Non Criminal and Returned", yaxis = list(title = 'Count'), barmode = 'group')
## 2014 Graph
Regions <- c("Africa", "Asia", "Europe", "North America", "South America")
remove_criminal_2014 <- c(africa.criminal.2014, asia.criminal.2014, europe.criminal.2014, northamerica.criminal.2014,
southamerica.criminal.2014)
remove_noncriminal_2014 <- c(africa.noncriminal.2014, asia.noncriminal.2014, europe.noncriminal.2014,
northamerica.noncriminal.2014, southamerica.noncriminal.2014)
return_2014 <- c(africa.return.2014, asia.return.2014, europe.return.2014, northamerica.return.2014, southhamerica.return.2014)
data.2014 <- data.frame(Regions, remove_criminal_2014, remove_noncriminal_2014)
graph.2014 <- plot_ly(data.2014, x = ~Regions, y = ~remove_criminal_2014, type = 'bar', name = 'Removed_Criminals') %>%
add_trace(y = ~return_2014, name = 'Returned') %>%
add_trace(y = ~remove_noncriminal_2014, name = 'Removed_NonCriminals') %>%
layout(title = "2014 Removal Criminal/Non Criminal and Returned", yaxis = list(title = 'Count'), barmode = 'group')
## 2015 Graph
Regions <- c("Africa", "Asia", "Europe", "North America", "South America")
remove_criminal_2015 <- c(africa.criminal.2015, asia.criminal.2015, europe.criminal.2015, northamerica.criminal.2015,
southamerica.criminal.2015)
remove_noncriminal_2015 <- c(africa.noncriminal.2015, asia.noncriminal.2015, europe.noncriminal.2015,
northamerica.noncriminal.2015, southamerica.noncriminal.2015)
return_2015 <- c(africa.return.2015, asia.return.2015, europe.return.2015, northamerica.return.2015, southhamerica.return.2015)
data.2015 <- data.frame(Regions, remove_criminal_2015, remove_noncriminal_2015)
graph.2015 <- plot_ly(data.2015, x = ~Regions, y = ~remove_criminal_2015, type = 'bar', name = 'Removed_Criminals') %>%
add_trace(y = ~return_2015, name = 'Returned') %>%
add_trace(y = ~remove_noncriminal_2015, name = 'Removed_NonCriminals') %>%
layout(title = "2015 Removal Criminal/Non Criminal and Returned", yaxis = list(title = 'Count'), barmode = 'group')
runApp()
View(returns)
View(removes)
rownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
View(removes)
rownames(returns) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
runApp()
runApp()
runApp()
runApp()
runApp()
View(removes)
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
View(removes)
runApp()
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
rownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
runApp()
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes.number <- removes[7, 4] = 11320
returns <- print(WorldPhones)
removes <- print(WorldPhones)
rownames(removes) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
removes[1, 1] = 250000
removes[2, 1] = 333567
removes [3, 1] = 399890
removes[4, 1] = 420033
removes[5, 1] = 345093
removes[6, 1] = 322983
removes[7, 1] = 395402
removes[1, 4] = 12000
removes[2, 4] = 11837
removes[3, 4] = 11272
removes[4, 4] = 11030
removes[5, 4] = 12320
removes[6, 4] = 12320
removes[7, 4] = 11320
rownames(returns) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
return <- read.csv("~/Desktop/Info201/immigration/data/returned.csv", stringsAsFactors = FALSE)
remove <- read.csv("~/Desktop/Info201/immigration/data/removed.csv", stringsAsFactors = FALSE)
return.updated2 <- return[-c(10),]
return.updated <- return.updated2[c(6:10),]
names(return.updated) <- c("Regions", "2009", "2010", "2011", "2012", "2013","2014", "2015")
remove.updated2 <- remove[-c(11),]
remove.updated <- remove.updated2[c(7:11),]
return.updated.year <- select(return.updated,"2009","2010","2011", "2012","2013","2014","2015")
remove.updated.year <- select(remove.updated,"X.9", "X.12","X.15","X.18","X.21","X.24","X.27")
names(remove.updated.year) <- c("2009", "2010", "2011", "2012", "2013", "2014", "2015")
runApp()
View(removes)
View(return)
View(returns)
>>>>>>> 129161f28d8a24c8e38470525d6c80b18b4cddf0
